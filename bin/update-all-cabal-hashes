#!/usr/bin/env bash

set -euo pipefail

COMMIT=$(curl "https://api.github.com/repos/commercialhaskell/all-cabal-hashes/commits/hackage" | jq --raw-output '.sha')

URL="https://github.com/commercialhaskell/all-cabal-hashes/archive/${COMMIT}.tar.gz"

HASH=$(nix-prefetch-url --type sha256 ${URL})

echo "{\"url\": \"${URL}\", \"sha256\": \"${HASH}\"}" | jq > all-cabal-hashes.json
